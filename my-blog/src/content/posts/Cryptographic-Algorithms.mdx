---
title: '密码算法概论'
date: '2024-03-31'
description: '密码学是研究信息加密与解密的科学，主要分为古典密码、对称加密和非对称加密三大类。古典密码包括单表替换（如凯撒密码）、多表替换（如维吉尼亚密码）和置换密码'
tags: ['安全']

---
# 基本概念
**什么是密码学？**
> 简单来说，密码学就是研究**编制密码**和**破译密码**的技术科学

**例题：**
![image.png](/images/image_png_4acb25a0ea29.png)
**密码学的三个阶段**

1. 古代到1949年：具有艺术性的科学
2. 1949到1975年：IBM制定了加密标准DES
3. 1976至今：1976年开创了公钥密码学，1978年公布了RSA密码体制，1991年发布了邮件加密软件PGP，2000年AES取代DES

**密码学的分类**

- 古典密码算法：替代加密、置换加密
- 对称加密算法：DES、AES
- 非对称加密算法：RSA、背包算法、Rabin、椭圆曲线等
> 目前在数据通讯中使用最普遍的是DES和RSA等

**什么是密码系统？**
> 密码系统又叫做密码体制，用数学符号表示为`S={M,C,K,E,D}`

- M表示：明文空间，即需要隐藏的信息
- C表示：密文空间，即明文加密后的信息
- K表示：密钥或密钥空间，通常指加解密算法的关键信息，可分为加密密钥和解密密钥
- E表示：加密算法
- D表示：解密算法

**密码体制的基本类型**

1. 错乱
2. 代替
3. 密本
4. 加乱

**破译或攻击密码的方法**
> 穷举攻击法，统计分析法，数学分析法

**什么是隐写术？**
> 隐写术就是将秘密的消息通过一种无伤大雅的消息发送出去。隐写术分为两种，**语言隐写术**，**技术隐写术**

**什么是符号码？**
![image.png](/images/image_png_3131d4e09da5.png)
**什么是公开代码？**
![image.png](/images/image_png_185d316a24dc.png)
# 对称密码
![image.png](/images/image_png_54225883baaa.png)
对称加密算法所需解决的问题：**密钥的安全传递问题**
> 如果加密和解密过程都使用相同的密钥或密钥算法，那么这种加密技术可以被归类为对称加密。


---

## 古典密码
> **古典密码**是[密码学](https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A2%BC%E5%AD%B8)中的其中一个类型，其大部分加密方式都是利用[替换式密码](https://zh.wikipedia.org/wiki/%E6%9B%BF%E6%8D%A2%E5%BC%8F%E5%AF%86%E7%A0%81)或[移项式密码](https://zh.wikipedia.org/w/index.php?title=%E7%A7%BB%E9%A0%85%E5%BC%8F%E5%AF%86%E7%A2%BC&action=edit&redlink=1)，有时则是两者的混合。

其中替换密码可以概括为**单表替换密码**、**多表替换密码**和**多字符替换密码**
### 单表替换密码
**什么是单表替换密码？**
> 单表替换密码就是使用一个密文字母表，并且用密文字母表中的一个字母来代换明文字母表中的一个字母

![image.png](/images/image_png_d7cdba2fdd0a.png)
**破解单表置换密码算法**
> 使用穷举法：次数26！=  4e26
> 使用统计法：

![image.png](/images/image_png_4dae39bbb3bd.png)
#### 凯撒密码
> **凯撒密码**（英语：Caesar cipher），或称**凯撒加密**、**凯撒变换**、**变换加密**，是一种最简单且最广为人知的加密技术。凯撒密码是一种[替换加密](https://zh.wikipedia.org/wiki/%E6%9B%BF%E6%8D%A2%E5%BC%8F%E5%AF%86%E7%A0%81)技术，[明文](https://zh.wikipedia.org/wiki/%E6%98%8E%E6%96%87)中的所有字母都在[字母表](https://zh.wikipedia.org/wiki/%E5%AD%97%E6%AF%8D%E8%A1%A8)上向后（或向前）按照一个固定数目进行偏移后被替换成[密文](https://zh.wikipedia.org/wiki/%E5%AF%86%E6%96%87)。例如，当偏移量是3的时候，所有的字母A将被替换成D，B变成E，以此类推。这个加密方法是以[罗马共和](https://zh.wikipedia.org/wiki/%E7%BE%85%E9%A6%AC%E5%85%B1%E5%92%8C)时期[凯撒](https://zh.wikipedia.org/wiki/%E5%87%B1%E6%92%92)的名字命名的，据称当年凯撒曾用此方法与其将军们进行联系。

**应用**
> 凯撒密码通常被作为其他更复杂的加密方法中的一个步骤，例如[维吉尼亚密码](https://zh.wikipedia.org/wiki/%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81)。凯撒密码还在现代的[ROT13](https://zh.wikipedia.org/wiki/ROT13)系统中被应用。但是和所有的利用字母表进行替换的加密技术一样，凯撒密码非常容易被破解，而且在实际应用中也无法保证通信安全。

![image.png](/images/image_png_73202aefd3d5.png)
凯撒密码的加密、解密方法还能够通过同余的数学方法进行计算。首先将字母用数字代替，A=0，B=1，...，Z=25。此时偏移量为n的加密方法即为：

![在这里插入图片描述](/images/在这里插入图片描述_89df0cc9990a.png)



#### 阿特巴西密码
> 阿特巴希密码**将字母表整个扭转**：第一个字母（aleph）与最后一个（taw）相替换，第二个（beth）与倒数第二个（shin）相替换，如此类推。密码学上的示沙克之谜出现在《[耶利米书](https://zh.wikipedia.org/wiki/%E8%80%B6%E5%88%A9%E7%B1%B3%E6%9B%B8)》中，ששך-_示沙克_（25:26；51:41）其实是加密后的בבל-_巴别_（即[巴比伦](https://zh.wikipedia.org/wiki/%E5%B7%B4%E6%AF%94%E5%80%AB)）。[[1]](https://zh.wikipedia.org/wiki/%E9%98%BF%E7%89%B9%E5%B7%B4%E5%B8%8C%E5%AF%86%E7%A2%BC#cite_note-1)[[2]](https://zh.wikipedia.org/wiki/%E9%98%BF%E7%89%B9%E5%B7%B4%E5%B8%8C%E5%AF%86%E7%A2%BC#cite_note-2)

现代希伯来文配合阿特巴希密码：
```
明文：  אבגדהוזחטיכלמנסעפצקרשת
密文：  תשרקצפעסנמלכיטחזוהדגבא
```
而罗马字母使用阿特巴希密码则是：
```
明文：  ABCDEFGHIJKLMNOPQRSTUVWXYZ
密文：  ZYXWVUTSRQPONMLKJIHGFEDCBA
```
### 多表替换密码
#### 维吉尼亚密码
**什么是多表替换加密？**
> 在一个多表替换密码中，会使用多个字母作为密码。为了加快加密或解密速度，所有的字母通常写在一张[表格](https://zh.wikipedia.org/wiki/%E8%A1%A8%E6%A0%BC)上，密码学上称作**tableau**。这种表格通常是26×26，因为这样才能放下全部26个英文字母。填充表格及选择下次使用的字母的方法，就是不同多字母替换密码之间的定义。多字母替换密码比单字母更难打破，因为其替换可能性多，密文要较长才可。

![在这里插入图片描述](/images/在这里插入图片描述_ddda5538cfe1.png)

用来加密和解密的维吉尼亚表格
维吉尼亚密码中，表格的第一行只需直接填上26个字母，然后以下每一行的字母都是向左偏移一格。（这叫作表格横移，数学上每一列同余26。）要用这种密码需要使用一个关键字来作为密钥。关键字每次用完就再次重复。假设关键字是“CAT”，明文的第一个字由“C”加密，第二个字由“A”加密，第三个则由“T”加密，然后再回到C加密，一直重复。然后按照右边的密码表加密，例如BALL用CAT作关键字时会加密至DAEN，可见即使是同一个“L”亦会加密至另一个字母。现实中，维吉尼亚密码的关键字非常长。
例如，假设[明文](https://zh.wikipedia.org/wiki/%E6%98%8E%E6%96%87)为：
```
ATTACKATDAWN
```
选择某一关键词并重复而得到密钥，如关键词为LEMON时，密钥为：
```
LEMONLEMONLE
```
对于明文的第一个字母A，对应密钥的第一个字母L，于是使用表格中L行字母表进行加密，得到[密文](https://zh.wikipedia.org/wiki/%E5%AF%86%E6%96%87)第一个字母L。类似地，明文第二个字母为T，在表格中使用对应的E行进行加密，得到密文第二个字母X。以此类推，可以得到：
```
明文：ATTACKATDAWN
密钥：LEMONLEMONLE
密文：LXFOPVEFRNHR
```
### 置换密码
![image.png](/images/image_png_ad4ac3cf3a12.png)
## **分组密码**
> 在[密码学](https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%AD%A6)中，**分组加密**（英语：**Block cipher**），又称**分块加密**或**块密码**，是一种[对称密钥算法](https://zh.wikipedia.org/wiki/%E5%AF%B9%E7%A7%B0%E5%AF%86%E9%92%A5%E7%AE%97%E6%B3%95)。它将明文分成多个等长的模块（block），使用确定的算法和[对称密钥](https://zh.wikipedia.org/wiki/%E5%AF%B9%E7%A7%B0%E5%AF%86%E9%92%A5)对每组分别加密解密。分组加密是极其重要的[加密协议](https://zh.wikipedia.org/wiki/%E5%8A%A0%E5%AF%86%E5%8D%8F%E8%AE%AE)组成，其中典型的如[AES](https://zh.wikipedia.org/wiki/%E9%AB%98%E7%B4%9A%E5%8A%A0%E5%AF%86%E6%A8%99%E6%BA%96)和[3DES](https://zh.wikipedia.org/wiki/3DES)作为美国政府核定的标准加密算法，应用领域从电子邮件加密到银行交易转帐，非常广泛。

![image.png](/images/image_png_e5dbe86729ba.png)
**什么是好的分组密码？**

- 分组长度足够大
- 密钥量足够大
- 密码变换足够复杂
- 加密和解密运算简单

**什么是扩散？**
> 扩散是指要将算法设计成明文每一比特的变化尽可能多地影响到输出密文序列的变化，以便隐蔽明文的统计特性

**什么是混乱？**
> 指在加解密变换过程中明文、密钥以及密文之间的关系尽可能地复杂化，以防密码破译者采用解析法(即通过建立并求解一些方程)进行破译攻击。

### DES算法
> 什么是DES，DES（英语：Data Encryption Standard，缩写为 DES）其实是[美国](https://zh.m.wikipedia.org/wiki/%E7%BE%8E%E5%9B%BD)联邦政府的[国家标准局](https://zh.m.wikipedia.org/wiki/%E5%9B%BD%E5%AE%B6%E6%A0%87%E5%87%86%E5%B1%80)确定为[联邦资料处理标准](https://zh.m.wikipedia.org/wiki/%E8%81%94%E9%82%A6%E8%B5%84%E6%96%99%E5%A4%84%E7%90%86%E6%A0%87%E5%87%86)（FIPS），随后在国际上广泛流传开来。

![image.png](/images/image_png_f2267f0a0fee.png)
[https://juejin.cn/post/7213743217337499709](https://juejin.cn/post/7213743217337499709)
### AES算法
> AES加密算法在维基百科上也叫做高级加密标准（英语：**A**dvanced **E**ncryption **S**tandard，[缩写](https://zh.wikipedia.org/wiki/%E7%BC%A9%E5%86%99)：AES），又称**Rijndael加密法**（荷兰语发音：[[ˈrɛindaːl]](https://zh.wikipedia.org/wiki/Help:%E8%8D%B7%E8%98%AD%E8%AA%9E%E5%9C%8B%E9%9A%9B%E9%9F%B3%E6%A8%99)，音似英文的“Rhine doll”），是[美国联邦政府](https://zh.wikipedia.org/wiki/%E7%BE%8E%E5%9B%BD%E8%81%94%E9%82%A6%E6%94%BF%E5%BA%9C)采用的一种[区块加密](https://zh.wikipedia.org/wiki/%E5%8D%80%E5%A1%8A%E5%8A%A0%E5%AF%86)标准。这个标准用来替代原先的[DES](https://zh.wikipedia.org/wiki/DES)，已经被多方分析且广为全世界所使用。经过五年的甄选流程，高级加密标准由[美国国家标准与技术研究院](https://zh.wikipedia.org/wiki/%E7%BE%8E%E5%9B%BD%E5%9B%BD%E5%AE%B6%E6%A0%87%E5%87%86%E4%B8%8E%E6%8A%80%E6%9C%AF%E7%A0%94%E7%A9%B6%E9%99%A2)（NIST）于2001年11月26日发布于FIPS PUB 197，并在2002年5月26日成为有效的标准。现在，高级加密标准已然成为[对称密钥加密](https://zh.wikipedia.org/wiki/%E5%AF%B9%E7%A7%B0%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86)中最流行的[算法](https://zh.wikipedia.org/wiki/%E6%BC%94%E7%AE%97%E6%B3%95)之一。

## 序列密码（流密码）
>    序列密码的主要原理是通过伪随机序列发生器产生性能优良的随机序列(或滚动密钥生成器)，使用该序列与明文序列叠加（或加密）来输出密文序列。

![image.png](/images/image_png_c1765866370a.png)
**序列密码和分组密码的不同之处是什么？**

1. 加密方式：序列密码一次处理一个或几个比特，分组密码一次处理固定大小的数据块，通常是64比特或128比特
2. 运算方式：序列密码通常以流模式（Stream Mode）运行，即它们生成一个连续的密钥流，然后将该密钥流与明文进行逐比特异或运算以产生密文。分组密码通常使用分组模式（Block Mode），其中输入数据被划分为固定大小的块，并且每个块在加密之前都是相互独立的。
# 非对称密码（公钥密码）
**为什么使用公钥密码体系（也称为非对称密码体系）？**

1. **密钥管理**：公钥密码体系允许通信双方使用不同的密钥（公钥和私钥）。发送方使用接收方的公钥进行加密，接收方使用自己的私钥进行解密。这种方式避免了传统的对称密码体系中需要在通信双方之间共享密钥的问题，简化了密钥管理。
2. **数字签名**：公钥密码体系还支持数字签名，发送方可以使用自己的私钥对消息进行签名，接收方可以使用发送方的公钥来验证签名的真实性。这种机制可以确保消息的完整性和认证性，防止信息被篡改或伪造。
3. **安全性**：在公钥密码体系中，私钥通常保存在安全的环境中，只有其拥有者可以访问。因此，即使公钥泄露，也不会危及通信的安全性。而在对称密码体系中，一旦密钥泄露，通信的安全性将受到严重威胁。
4. **密钥交换**：公钥密码体系可以用于安全地进行密钥交换。通信双方可以使用对方的公钥加密一个临时的对称密钥，然后使用这个对称密钥进行后续的通信。这种方式称为密钥交换协议，例如Diffie-Hellman密钥交换。

![image.png](/images/image_png_4e44df59c681.png)
## **非对称密码机制下的密钥协商**
**Diffie-Hellman密钥交换：**
![image.png](/images/image_png_d5f082bf9caa.png)
![image.png](/images/image_png_d2188997947d.png)
![image.png](/images/image_png_6c12419fbe05.png)
## **Diffie-Hellman密钥交换机制中的中间人攻击**
![image.png](/images/image_png_4b3687ee9577.png)
## RSA算法
> **RSA加密算法**是一种[非对称加密算法](https://zh.wikipedia.org/wiki/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95)，在[公开密钥加密](https://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86)和[电子商业](https://zh.wikipedia.org/wiki/%E7%94%B5%E5%AD%90%E5%95%86%E4%B8%9A)中被广泛使用。RSA是由[罗纳德·李维斯特](https://zh.wikipedia.org/wiki/%E7%BD%97%E7%BA%B3%E5%BE%B7%C2%B7%E6%9D%8E%E7%BB%B4%E6%96%AF%E7%89%B9)（Ron Rivest）、[阿迪·萨莫尔](https://zh.wikipedia.org/wiki/%E9%98%BF%E8%BF%AA%C2%B7%E8%90%A8%E8%8E%AB%E5%B0%94)（Adi Shamir）和[伦纳德·阿德曼](https://zh.wikipedia.org/wiki/%E4%BC%A6%E7%BA%B3%E5%BE%B7%C2%B7%E9%98%BF%E5%BE%B7%E6%9B%BC)（Leonard Adleman）在1977年一起提出的。当时他们三人都在[麻省理工学院](https://zh.wikipedia.org/wiki/%E9%BA%BB%E7%9C%81%E7%90%86%E5%B7%A5%E5%AD%A6%E9%99%A2)工作。RSA 就是他们三人姓氏开头字母拼在一起组成的。[[1]](https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95#cite_note-1)

### 公钥和私钥的产生

![在这里插入图片描述](/images/在这里插入图片描述_67278059b149.png)


（N,e）是公钥，（N,d）是私钥，Alice将她的公钥（N,e）传给Bob，将她的私钥（N,d）藏起来。
加解密消息以及证明，详见：[RSA加解密算法](https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95#cite_note-1)
![image.png](/images/image_png_76ea0475e3d9.png)
# 杂凑函数和消息认证码
## 密码散列算法
> 密码散列算法也称为单向散列函数、杂凑函数、哈希算法、HASH算法或消息摘要算法。它通过一个单向数学函数，将**任意长度**的一块数据转换为一个**定长不可逆转的数据**，这段数据通常叫做**消息摘要**。典型的散列函数有：MD5 （Message-Digest Algorithm 5） ，SHA-1等。

### 摘要算法的特性

- 不可逆
- 对任何长度的信息进行哈希后，结果都是一个固定长度的数据摘要，摘要的长度通常为128 bits或160 bits
- 原始信息中一个字节的改变会导致摘要后的结果发生变化

![image.png](/images/image_png_ebdcf32f9e5f.png)
**什么是好的散列函数？**
好的散列函数应该具备以下几个特点：

1. **均匀性**：散列函数应该尽可能地均匀地将输入空间映射到输出空间，即不同的输入应该尽可能地分布在输出空间的各个位置上。这样可以降低碰撞（两个不同的输入映射到同一个输出）的概率，提高散列算法的性能和安全性。
2. **无法逆向推导**：好的散列函数应该是单向的，即很难从散列值反推出原始输入。这样可以保护原始数据的机密性，防止被逆向破解。
3. **抗碰撞性**：好的散列函数应该具有较低的碰撞概率，即不同的输入在经过散列函数计算后产生相同的输出的可能性应该尽可能地小。这样可以提高数据的完整性和可靠性。
4. **高效性**：散列函数的计算速度应该尽可能地快，尤其是在处理大量数据时。高效的散列函数可以降低系统的计算开销，提高系统的性能。
5. **抗碰撞性**：好的散列函数应该对输入数据的细微变化具有很高的敏感性，即如果输入数据发生了微小的改变，其散列值应该发生显著的变化。这样可以保证散列函数在应用于数据完整性校验等场景时的有效性。
# 数字签名
> 数字签名（Digital Signature）又称公钥数字签名或电子签章，是以电子形式存储于信息中或以附件或逻辑上与之有联系的数据，用于辨识数据签署人的身份，并表明签署人对数据中所包信息的认可。在网络环境中，数字签名完全可以代替现实中的“亲笔签字”。数字签名是公钥加密技术与数字摘要技术的应用。

## 数字签名的作用

- 保证传输信息的完整性
- 发送者的身份认证
- 防止交易过程抵赖行为的发生
## 数字签名的基本原理
> 发送者用自己的私有密钥加密数据后传给接收者，接收者用发送者的公钥解开数据后，就可确定消息来自于谁，同时也是对发送者发送的信息的真实性的一个证明，发送者对所发信息不能抵赖。

![image.png](/images/image_png_c76a51e0c0f5.png)
![image.png](/images/image_png_6eea24dd96df.png)
# 密码学新方向
![image.png](/images/image_png_181e53186278.png)
![image.png](/images/image_png_33ab75367beb.png)
![image.png](/images/image_png_a692a1ca56dc.png)
